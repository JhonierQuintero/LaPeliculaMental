<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mi Pel√≠cula Mental</title>
    
    <!-- Librer√≠a para las animaciones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="./style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="icon" href="data:,">
</head>
<body>
    <div class="bubbles-container"></div>
    <div class="theme-switcher no-print" title="Seleccionar tema">
        <select id="theme-select" aria-label="Seleccionar tema">
            <option value="light">Claro ‚òÄ</option>
            <option value="dark">Oscuro üåô</option>
            <option value="warm">C√°lido üî•</option>
            <option value="cold">Fr√≠o ‚ùÑ</option>
        </select>
    </div>

    <main class="container" id="app">
        <!-- PANTALLA DE BIENVENIDA -->
        <section id="welcome-screen" class="screen active">
            <div class="card" style="text-align:center">
                <h1>¬øEst√°s listo para crear tu pel√≠cula mental?</h1>
                <p class="muted">Haz clic en comenzar y responde unas preguntas para construir tu pel√≠cula mental personalizada.</p>
                <p class="quote">El futuro pertenece a quienes creen en la belleza de sus sue√±os.</p>
                <div style="margin-top:2rem">
                    <button id="start-btn" class="no-print">Comenzar</button>
                </div>
            </div>
        </section>

        <!-- PANTALLA DEL FORMULARIO -->
        <section id="form-screen" class="screen">
            <form id="movie-form" class="card" novalidate>
                <h2>Crea tu Pel√≠cula Mental</h2>
                <p class="quote">Cada gran logro comienza con la decisi√≥n de intentarlo.</p>

                <div class="form-row">
                    <div class="form-group">
                        <label for="user-name">Tu Nombre <span aria-hidden="true">*</span></label>
                        <input id="user-name" type="text" required maxlength="80" />
                    </div>
                    <div class="form-group">
                        <label for="user-age">Tu Edad</label>
                        <input id="user-age" type="number" min="1" max="120" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="form-title">T√≠tulo de tu Pel√≠cula <span aria-hidden="true">*</span></label>
                    <input id="form-title" type="text" required maxlength="120" />
                </div>

                <div class="form-group">
                    <label for="form-description">¬øC√≥mo es tu pel√≠cula mental?</label>
                    <textarea id="form-description" maxlength="1000" placeholder="Describe c√≥mo te imaginas tu pel√≠cula mental..."></textarea>
                </div>

                <div class="card" style="padding:1.5rem;margin-top:1rem; animation: none;">
                    <h3>Metas a Futuro</h3>
                    <div class="form-group">
                        <label for="goal-2y">Metas a 2 a√±os</label>
                        <textarea id="goal-2y" rows="2" maxlength="600"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="goal-5y">Metas a 5 a√±os</label>
                        <textarea id="goal-5y" rows="2" maxlength="600"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="goal-10y">Metas a 10 a√±os</label>
                        <textarea id="goal-10y" rows="2" maxlength="600"></textarea>
                    </div>
                </div>

                <div class="card" style="padding:1.5rem;margin-top:1rem; animation: none;">
    <h3>Recursos Multimedia</h3>
    <!-- SECCI√ìN DE M√öSICA MEJORADA -->
    <div class="form-group">
        <label for="audio-upload">Sube tu M√∫sica de Fondo (m√°x 5 MB)</label>
        <input id="audio-upload" type="file" accept="audio/*" />
        
        <h4 class="preset-title">O elige una opci√≥n predeterminada:</h4>
        <div class="preset-audio-options">
            <button type="button" class="preset-audio-btn" data-src="./assets/musica-default/sombras-del-pasado.mp3">Inspiraci√≥n</button>
            <button type="button" class="preset-audio-btn" data-src="./assets/musica-default/cascade.mp3">Calma</button>
            <button type="button" class="preset-audio-btn" data-src="./assets/musica-default/happy-day.mp3">Energ√≠a</button>
        </div>
    </div>
    
    <!-- SECCI√ìN DE IM√ÅGENES MEJORADA -->
    <div class="form-group">
        <label for="image-upload">Sube tus Im√°genes (m√°x 5 MB c/u)</label>
        <input id="image-upload" type="file" accept="image/*" multiple />

        <h4 class="preset-title">O elige de nuestra galer√≠a:</h4>
        <div class="preset-image-gallery" id="preset-image-gallery">
            <!-- Las im√°genes predeterminadas se insertar√°n aqu√≠ con JavaScript -->
        </div>

        <div class="image-previews" id="image-preview-container" aria-live="polite"></div>
    </div>
</div>

                <div style="display:flex;gap:.8rem;flex-wrap:wrap;margin-top:1rem; justify-content: center;">
                    <button type="submit" id="create-btn" class="no-print">Crear mi Pel√≠cula Mental</button>
                    <!-- <button type="button" id="download-json-btn" class="secondary no-print">Descargar JSON</button> -->
                </div>
            </form>
        </section>

        <!-- PANTALLA DE LA PEL√çCULA CREADA (ESTRUCTURA MODIFICADA) -->
        <section id="movie-screen" class="screen">
            <!-- El encabezado principal se mantiene igual y siempre visible -->
            <div class="movie-header card">
                <h1 id="movie-title">T√≠tulo</h1>
                <p id="movie-description" class="muted">Descripci√≥n</p>
                <div id="movie-audio-player" style="margin-top:1rem"></div>
                
                <!-- Controles para editar la m√∫sica -->
                <div class="edit-controls no-print">
                    <button id="change-audio-btn" class="edit-button">Cambiar M√∫sica</button>
                    <input type="file" id="audio-updater" accept="audio/*" class="hidden-input">
                </div>
            </div>
        
            

            <!-- Contenedor para los paneles -->
            <div class="movie-panels">
                <!-- Panel 1: Resumen (contiene Detalles y Metas) -->
                <div id="panel-summary" class="movie-panel active">
                    <div class="card">
                        <h3>Detalles</h3>
                        <ul class="info-list">
                            <li><strong>Creador:</strong> <span id="movie-user-name" class="muted"></span></li>
                            <li><strong>Edad:</strong> <span id="movie-user-age" class="muted"></span></li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Metas a Futuro</h3>
                        <ul class="info-list">
                            <li><strong>A 2 a√±os:</strong> <span id="movie-goal-2y" class="muted"></span></li>
                            <li><strong>A 5 a√±os:</strong> <span id="movie-goal-5y" class="muted"></span></li>
                            <li><strong>A 10 a√±os:</strong> <span id="movie-goal-10y" class="muted"></span></li>
                        </ul>
                    </div>
                </div>
                

                <!-- Panel 2: Galer√≠a -->
                <div id="panel-gallery" class="movie-panel">
                    <div class="card" id="gallery-panel-card">
                        <h3>Galer√≠a de Sue√±os</h3>
                        <div id="movie-image-gallery"></div>
                        <!-- Controles para a√±adir im√°genes -->
                        <div class="edit-controls no-print">
                            <button id="add-images-btn" class="edit-button">A√±adir Im√°genes</button>
                            <input type="file" id="image-updater" accept="image/*" multiple class="hidden-input">
                        </div>
                    </div>
                </div>

                <!-- Panel 3: Plan de Acci√≥n (Tareas) -->
                <div id="panel-tasks" class="movie-panel">
                    <div class="card" id="task-panel-card">
                        <h3>Tareas para alcanzar tu meta</h3>
                        <ul id="task-list"></ul>
                        <form id="new-task-form" class="no-print" aria-label="A√±adir tarea">
                            <div class="form-group">
                                <label for="new-task-input">Nueva Tarea</label>
                                <input id="new-task-input" type="text" placeholder="Ej: Investigar cursos de finanzas..." maxlength="180" required />
                            </div>
                            <div class="task-form-row"> <!-- Usamos la nueva clase aqu√≠ -->
                                <div class="form-group">
                                    <label for="new-task-date">Fecha L√≠mite (Opcional)</label>
                                    <input id="new-task-date" type="date" />
                                </div>
                                <div class="form-group">
                                    <label for="new-task-notes">Notas (Opcional)</label>
                                    <input id="new-task-notes" type="text" placeholder="Ej: Empezar con el libro X..." maxlength="200" />
                                </div>
                            </div>
                            <button type="submit">A√±adir Tarea</button>
                        </form>                     

                        <div style="margin-top:1.5rem">
                            <p id="progress-text" class="muted"></p>
                            <div id="progress-bar-container"><div id="progress-bar"></div></div>
                        </div>
                    </div>
                </div>
                
                <!-- Panel 4: Panel de Inspiraci√≥n -->
                <div id="panel-inspiration" class="movie-panel">
                    <div class="card">
                        <h3>Busca tu Inspiraci√≥n</h3>
                        <p class="muted" style="margin-bottom: 2rem;">A veces, solo necesitas un peque√±o empuj√≥n. Presiona el bot√≥n para recibir una reflexi√≥n sobre el poder de tus sue√±os.</p>
                        <button id="generate-reflection-btn">Generar Reflexi√≥n</button>
                        <div id="reflection-box" class="reflection-box">
                            <!-- La reflexi√≥n aparecer√° aqu√≠ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controles inferiores -->
            <div class="controls-panel no-print">
                <button id="export-pdf-btn" class="secondary">Exportar a PDF / Imprimir</button>
                <button id="pelicula-mental">Reproduce mi pel√≠cula virtual</button>
                <button id="export-vision-card-btn" class="secondary">Descargar Tarjeta</button>
                <!-- <button id="download-all-json-btn">Descargar todo (JSON)</button> -->
                <button id="delete-movie-btn" class="danger">Eliminar pel√≠cula mental</button>
            </div>
        </section>
    </main>

    <!-- Plantilla Oculta para la Tarjeta de Visi√≥n -->
    <div id="vision-card-template" aria-hidden="true">
        <h2 id="card-title"></h2>
        <div id="card-images"></div>
        <p id="card-goal"></p>
        <span id="card-creator"></span>
    </div>  

    <footer class="footer-quote no-print">
        ¬°Sigue adelante! Cada paso, por peque√±o que sea, te acerca a la obra maestra que es tu futuro.
    </footer>

    <!-- MODAL PARA IMAGEN AMPLIADA -->
    <div id="image-modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
        <img id="modal-img" alt="Imagen ampliada" />
    </div>

    <!-- CARRUSEL AUTOM√ÅTICO PARA PEL√çCULA MENTAL -->
    <div id="carousel-overlay">
        <div class="carousel-container">
            <div id="carousel-slides-container">
                <!-- Las diapositivas se insertar√°n aqu√≠ con JavaScript -->
            </div>
        </div>
        <button id="carousel-close" title="Cerrar">&times;</button>
    </div>

    <!-- Logro Desbloqueado Overlay -->
<div id="achievement-overlay" class="achievement-overlay">
    <div class="achievement-content">
        <h2 id="achievement-title">¬°Hito Alcanzado!</h2>
        <p id="achievement-text">Has completado una tarea. ¬°Est√°s un paso m√°s cerca de tu sue√±o!</p>
    </div>
</div>

    <script src="./script.js"></script>
</body>
</html>